<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorator="layout">
<head>
<title>Issues / Pull Requests</title>
</head>
<body>
  <div layout:fragment="header" th:remove="tag">
    <h1>
      <i class="icon github"></i>Issues / Pull Requests
    </h1>
  </div>

  <div layout:fragment="contents">
    <button class="fluid ui button labeled icon primary modalable">
      <i class="icon search"></i>edit search condition
    </button>
    <div th:include="components/issues::modal"></div>


    <div th:switch="${issues == null}">
      <div th:case="true">
        <script type="text/javascript">
									$('.modalable').click();
								</script>
      </div>
      <div th:case="*">
        <div class="ui message positive">
          <i class="icon close"></i>
          <div class="header">Search issues completed!</div>
          <p th:text="|Getting ${#lists.size(issues)} issues / pull requests.|"></p>
        </div>

        <table class="ui selectable celled table">
          <thead>
            <tr>
              <th>Repository/Issue No.</th>
              <th>Title</th>
              <th>Labels</th>
              <th>Milestone</th>
              <th>State</th>
              <th>Assignees</th>
            </tr>
          </thead>
          <tbody th:each="issue : ${issues}" th:remove="all-but-first">
            <tr>
              <td>
                <div class="ui ribbon label">
                  <a th:href="${issue.htmlUrl}" th:text="|${issue.repository}#${issue.number}|"></a>
                </div>
              </td>
              <td>
                <span th:text="${issue.title}"></span>
                <div class="ui label">
                  <i class="icon comments"></i><span th:text="${issue.comments}"></span>
                </div>
              </td>
              <td>
                <div class="ui tag labels">
                  <a class="ui label" th:each="label : ${issue.labels}"
                    th:style="|background-color: ${label.colorCode}|" th:href="${label.htmlUrl}" th:text="${label.name}"></a>
                </div>
              </td>
              <td th:with="milestone=${issue.milestone}">
                <div th:if="${milestone != null}">
                  <i class="icon wait"></i>
                  <a th:href="${milestone.htmlUrl}" th:text="${milestone.title}"></a>
                </div>
              </td>
              <td>
                <div th:switch="${issue.state == 'closed'}">
                  <div th:case="true">
                    <div class="ui label blue">
                      <i class="icon checkmark"></i><span th:text="${issue.state}"></span>
                    </div>
                  </div>
                  <div th:case="*">
                    <div class="ui label red">
                      <i class="icon bomb"></i><span th:text="${issue.state}"></span>
                    </div>
                  </div>
                </div>
              </td>
              <td>
                <div th:each="assignee : ${issue.assignees}">
                  <i class="icon user"></i>
                  <a th:href="${assignee.htmlUrl}" th:text="${assignee.login}"></a>
                </div>
              </td>
            </tr>
          </tbody>
        </table>

        <script type="text/javascript">
									$('.message .close').on(
											'click',
											function() {
												$(this).closest('.message')
														.transition('fade');
											});
								</script>
      </div>
    </div>
  </div>
  s
  <div layout:fragment="scripts"></div>
</body>
</html>